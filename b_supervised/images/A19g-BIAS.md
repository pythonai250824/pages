


# נאיב בייס - הקדמה

## מהו Naive Bayes?

ה- **Naive Bayes** → מודל למידה מונחה (supervised) יעיל במיוחד, בעיקר בהקשר של עיבוד שפה טבעית (**NLP**). היעילות שלו נובעת מהפשטות והמהירות, מה שהופך אותו למתאים למשימות כמו:
- סיווג טקסטים
- זיהוי ספאם
- ניתוח סנטימנט (sentiment analysis)
- קטלוג מסמכים

ה- Naive Bayes הוא משפחה של מסווגים הסתברותיים פשוטים, המבוססים על יישום **נוסחת בייס**, תחת הנחה חזקה של **עצמאות תנאית** (כלומר, כל מאפיין בלתי תלוי באחרים בהינתן התוצאה)

## נוסחת בייס - Bayes' Theorem

ה- **Bayes' Theorem** → נוסחת בייס מחשבת את ההסתברות שאירוע חדש יתרחש, בהתבסס על הסתברויות של אירועים שהתרחשו בעבר.

### הסבר אינטואיטיבי

אם אנחנו יודעים מה ההסתברות של B כאשר A מתקיים, ומה ההסתברויות הבסיסיות של כל אחד מהאירועים, נוכל לחשב את ההסתברות ההפוכה – A בהינתן ש-Bהתרחש

**נוסחת בייס** היא נוסחה מתורת ההסתברות המאפשרת לחשב את ההסתברות של אירוע חדש בהינתן מידע קודם. הנוסחה היא:

$$
P(A|B) = \frac{P(B|A) \cdot P(A)}{P(B)}
$$

כאשר:

- P(A|B): ההסתברות שאירוע א קרה בהינתן ש-ב קרה
- P(B|A): ההסתברות ש-ב קורה בהינתן ש-א קרה
- P(A): ההסתברות הבסיסית שאירוע א יקרה
- P(B): ההסתברות הבסיסית שאירוע ב יקרה

### נאיב בייס - דוגמה פשוטה

#### תיאור התרחיש

נניח שאנחנו גרים בעיר בה בכל בניין יש מערכת גילוי עשן עצמאית. לפעמים המערכת נותנת אזעקת שווא – כלומר מזוהה עשן אך אין באמת שריפה (למשל, עשן מתנור)

#### נתונים ידועים:
- שריפות אמיתיות מתרחשות רק ב-1% מהמקרים → P(A) = 0.01
- אזעקות מופעלות ב-10% מהמקרים → P(B) = 0.1
- אזעקה מופעלת ב-95% ממקרי השריפה האמיתיים → P(B|A) = 0.95

#### השאלה

בהינתן שהאזעקה הופעלה, מה ההסתברות שיש באמת שריפה?

#### נאיב בייס - פתרון הדוגמה

**הגדרת האירועים:**
- פ- A: שריפה אמיתית
- פ- B: הופעלה אזעקת עשן
- פ- נדרש לחשב P(A|B)

 **שימוש בנוסחת בייס:**

$$
P(A|B) = \frac{P(B|A) \cdot P(A)}{P(B)} = \frac{0.95 \cdot 0.01}{0.1} = \frac{0.0095}{0.1} = 0.095
$$

**תוצאה:**
ההסתברות שיש באמת שריפה כאשר האזעקה הופעלה היא **9.5%**

### דוגמא נוספת

#### תיאור התרחיש

בדיקה רפואית למחלה נדירה עם הנתונים הבאים:

- המחלה נדירה ומופיעה רק אצל 0.5% מהאוכלוסייה → P(A) = 0.005
- הבדיקה מזהה נכונה את המחלה ב-99% מהמקרים החיוביים → P(B|A) = 0.99
- הבדיקה נותנת חיובי שגוי ב-2% מהמקרים (לא חולים) → P(B| **not** A) = 0.02

#### שאלה:
מה ההסתברות שמישהו באמת חולה אם הבדיקה יצאה חיובית?

#### פתרון

**נתונים מהשאלה:**

- המחלה נדירה ומופיעה רק אצל 0.5% מהאוכלוסייה  
  → P(A) = 0.005
  לכן, הסתברות לא להיות חולה:  
  → P(**not** A) = 1 - 0.005 = 0.995  
- הבדיקה מזהה נכון את החולים ב־99% מהמקרים  
  → P(B|A) = 0.99
- הבדיקה נותנת חיובי שגוי ב־2% מהמקרים הבריאים  
  → P(B| **not** A) = 0.02

**מה נדרש לחשב?**

מה ההסתברות שאדם **באמת חולה**, בהינתן שהתוצאה של הבדיקה חיובית?

כלומר נחשב את:  
P(A|B) = ?

**שלב 1: חישוב הסתברות שהתוצאה חיובית P(B)**

כאן מציאת P(B) יותר מורכבת כי אנו יודעים רק את P(B| not A)

ראשית נגדיר הסתברות שאירוע לא קורה

$$
P(\neg A) = **not**APropability
$$

$$
P(\neg A) = 1 - P(A)
$$


כעת נשתמש בכלל ההסתברות הכוללת:

הנוסחא מחשבת את ההסתברות הכוללת לכך שאירוע ב יקרה, גם אם איננו יודעים בוודאות האם א קרה או לא

$$
P(B) = P(B|A) \cdot P(A) + P(B|\neg A) \cdot P(\neg A)
$$

נציב את הערכים:

$$
P(B) = 0.99 \cdot 0.005 + 0.02 \cdot 0.995 = 0.00495 + 0.0199 = 0.02485
$$

**שלב 2: נציב הכל בנוסחת בייס**

$$
P(A|B) = \frac{P(B|A) \cdot P(A)}{P(B)} = \frac{0.99 \cdot 0.005}{0.02485} = \frac{0.00495}{0.02485} ≈ 0.199
$$

**תוצאה סופית:**

**ההסתברות שאדם באמת חולה כאשר הבדיקה חיובית היא ≈ 19.9%**

#### מסקנה:

למרות שהבדיקה מאוד מדויקת, בגלל שהמחלה נדירה – רוב מי שמקבל תוצאה חיובית **לא באמת חולה**. זה מדגים עד כמה חשוב להבין את **הקשר בין שכיחות המחלה לבין אמינות הבדיקה**


